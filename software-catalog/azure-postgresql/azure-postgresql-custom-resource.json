{
  "generator": {
    "configurationBaseFolder": "terraform",
    "templates": [
      {
        "name": "variables",
        "fileExtension": "tf",
        "folderName": "postgresql",
        "template": "variable \"_module_source\" {\n  default = \"git::https://github.com/Mia-Platform-Experiments/tf-azure-postgresql.git\"\n}\n\nvariable \"service_name\" {\n  description = \"The name of the service (e.g., payment-service). Used for resource naming. Note: PostgreSQL server names must be globally unique in Azure.\"\n  type        = string\n  default     = \"%spec.service_name%\"\n}\n\nvariable \"resource_group_name\" {\n  description = \"The name of the existing Resource Group in Azure.\"\n  type        = string\n  default     = \"%spec.resource_group_name%\"\n}\n\nvariable \"location\" {\n  description = \"The Azure region to deploy to.\"\n  type        = string\n  default     = \"%spec.location%\"\n}\n\nvariable \"performance_profile\" {\n  description = \"The performance tier selected by the developer (sandbox, development, production). Storage size, backup retention, and high availability are automatically configured based on this profile.\"\n  type        = string\n  default     = \"%spec.performance_profile%\"\n\n  validation {\n    condition     = contains([\"sandbox\", \"development\", \"production\"], var.performance_profile)\n    error_message = \"Performance profile must be one of: sandbox, development, production.\"\n  }\n}\n\nvariable \"postgres_version\" {\n  description = \"The PostgreSQL version to deploy.\"\n  type        = string\n  default     = \"%spec.postgres_version%\"\n}\n\nvariable \"database_name\" {\n  description = \"The name of the database to create.\"\n  type        = string\n  default     = \"%spec.database_name%\"\n}\n\nvariable \"administrator_login\" {\n  description = \"The administrator username for the PostgreSQL server.\"\n  type        = string\n  default     = \"%spec.administrator_login%\"\n}\n\nvariable \"administrator_password\" {\n  description = \"The administrator password for the PostgreSQL server. Note: Change this default value before deploying to production.\"\n  type        = string\n  default     = \"%spec.administrator_password%\"\n  sensitive   = true\n}"
      }
    ],
    "type": "template"
  },
  "meta": {
    "apiVersion": "custom-generator.console.mia-platform.eu/v1",
    "kind": "AzurePostgreSQLTemplateGenerator"
  },
  "name": "my-azure-postgresql",
  "jsonSchema": {
    "type": "object",
    "required": [
      "service_name",
      "resource_group_name",
      "location",
      "performance_profile",
      "database_name",
      "administrator_login",
      "administrator_password"
    ],
    "properties": {
      "service_name": {
        "type": "string",
        "description": "The name of the service (e.g., payment-service). Used for resource naming. Note: PostgreSQL server names must be globally unique in Azure.",
        "examples": [
          "payment-db",
          "user-db",
          "analytics-db"
        ]
      },
      "resource_group_name": {
        "type": "string",
        "description": "The name of the existing Resource Group in Azure.",
        "default": "terraform-demo",
        "examples": [
          "terraform-demo",
          "production-rg"
        ]
      },
      "location": {
        "type": "string",
        "description": "The Azure region to deploy to.",
        "default": "North Europe",
        "enum": [
          "East US",
          "West US",
          "North Europe",
          "West Europe",
          "East Asia",
          "Southeast Asia",
          "Canada Central",
          "Australia East"
        ]
      },
      "performance_profile": {
        "type": "string",
        "description": "The performance tier selected by the developer (sandbox, development, production). Storage size, backup retention, and high availability are automatically configured based on this profile.",
        "default": "sandbox",
        "enum": [
          "sandbox",
          "development",
          "production"
        ]
      },
      "postgres_version": {
        "type": "string",
        "description": "The PostgreSQL version to deploy.",
        "default": "16",
        "enum": [
          "16",
          "15",
          "14",
          "13"
        ]
      },
      "database_name": {
        "type": "string",
        "description": "The name of the database to create.",
        "examples": [
          "appdb",
          "maindb",
          "datastore"
        ]
      },
      "administrator_login": {
        "type": "string",
        "description": "The administrator username for the PostgreSQL server.",
        "default": "psqladmin",
        "examples": [
          "psqladmin",
          "dbadmin"
        ]
      },
      "administrator_password": {
        "type": "string",
        "description": "The administrator password for the PostgreSQL server. Must be at least 8 characters. Note: Change this default value before deploying to production.",
        "default": "change_me",
        "minLength": 8,
        "examples": [
          "MySecurePassword123!"
        ]
      }
    }
  },
  "spec": {
    "variables": [
      {
        "name": "service_name",
        "description": "The name of the service (e.g., payment-service). Used for resource naming.",
        "type": "string"
      },
      {
        "name": "resource_group_name",
        "description": "The name of the existing Resource Group in Azure.",
        "type": "string",
        "default": "terraform-demo"
      },
      {
        "name": "location",
        "description": "The Azure region to deploy to.",
        "type": "string",
        "default": "North Europe"
      },
      {
        "name": "performance_profile",
        "description": "The performance tier selected by the developer (sandbox, development, production).",
        "type": "string",
        "default": "sandbox"
      },
      {
        "name": "postgres_version",
        "description": "The PostgreSQL version to deploy.",
        "type": "string",
        "default": "16"
      },
      {
        "name": "database_name",
        "description": "The name of the database to create.",
        "type": "string"
      },
      {
        "name": "administrator_login",
        "description": "The administrator username for the PostgreSQL server.",
        "type": "string",
        "default": "psqladmin"
      },
      {
        "name": "administrator_password",
        "description": "The administrator password for the PostgreSQL server.",
        "type": "string",
        "default": "change_me"
      }
    ]
  }
}
