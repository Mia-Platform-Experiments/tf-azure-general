{
  "generator": {
    "configurationBaseFolder": "terraform",
    "templates": [
      {
        "name": "variables",
        "fileExtension": "tf",
        "folderName": "storage-account",
        "template": "variable \"service_name\" {\n  description = \"The name of the service (e.g., paymentservice). Used for storage account naming. Must be 3-24 lowercase alphanumeric characters. Note: Storage account names must be globally unique in Azure.\"\n  type        = string\n  default     = \"%spec.service_name%\"\n\n  validation {\n    condition     = can(regex(\"^[a-z0-9]{3,24}$\", var.service_name))\n    error_message = \"Service name must be 3-24 lowercase alphanumeric characters only (no hyphens or special characters).\"\n  }\n}\n\nvariable \"resource_group_name\" {\n  description = \"The name of the existing Resource Group in Azure.\"\n  type        = string\n  default     = \"%spec.resource_group_name%\"\n}\n\nvariable \"location\" {\n  description = \"The Azure region to deploy to.\"\n  type        = string\n  default     = \"%spec.location%\"\n}\n\nvariable \"performance_profile\" {\n  description = \"The performance tier selected by the developer (sandbox, development, production). Account tier and replication type are automatically configured based on this profile.\"\n  type        = string\n  default     = \"%spec.performance_profile%\"\n\n  validation {\n    condition     = contains([\"sandbox\", \"development\", \"production\"], var.performance_profile)\n    error_message = \"Performance profile must be one of: sandbox, development, production.\"\n  }\n}\n\nvariable \"container_names\" {\n  description = \"List of blob container names to create (optional).\"\n  type        = list(string)\n  default     = [%#spec.container_names%\"%value%\"%^last%,%/last%%/spec.container_names%]\n}\n\nvariable \"access_tier\" {\n  description = \"The access tier for the storage account.\"\n  type        = string\n  default     = \"%spec.access_tier%\"\n}"
      }
    ],
    "type": "template"
  },
  "meta": {
    "apiVersion": "custom-generator.console.mia-platform.eu/v1",
    "kind": "AzureStorageAccountTemplateGenerator"
  },
  "name": "my-azure-storage-account",
  "jsonSchema": {
    "type": "object",
    "required": [
      "service_name",
      "resource_group_name",
      "location",
      "performance_profile"
    ],
    "properties": {
      "service_name": {
        "type": "string",
        "description": "The name of the service (e.g., paymentservice). Used for storage account naming. Must be 3-24 lowercase alphanumeric characters. Note: Storage account names must be globally unique in Azure - consider appending environment or random suffix.",
        "pattern": "^[a-z0-9]{3,24}$",
        "examples": [
          "paymentstorage",
          "userstorage",
          "appdata"
        ]
      },
      "resource_group_name": {
        "type": "string",
        "description": "The name of the existing Resource Group in Azure.",
        "default": "terraform-demo",
        "examples": [
          "terraform-demo",
          "production-rg"
        ]
      },
      "location": {
        "type": "string",
        "description": "The Azure region to deploy to.",
        "default": "West Europe",
        "enum": [
          "East US",
          "West US",
          "North Europe",
          "West Europe",
          "East Asia",
          "Southeast Asia",
          "Canada Central",
          "Australia East"
        ]
      },
      "performance_profile": {
        "type": "string",
        "description": "The performance tier selected by the developer (sandbox, development, production). Account tier and replication type are automatically configured based on this profile.",
        "default": "sandbox",
        "enum": [
          "sandbox",
          "development",
          "production"
        ]
      },
      "container_names": {
        "type": "array",
        "description": "List of blob container names to create (optional).",
        "items": {
          "type": "string"
        },
        "default": [
          "default-container"
        ],
        "examples": [
          ["uploads", "backups"],
          ["documents"]
        ]
      },
      "access_tier": {
        "type": "string",
        "description": "The access tier for the storage account.",
        "default": "Hot",
        "enum": [
          "Hot",
          "Cool"
        ]
      }
    }
  },
  "spec": {
    "variables": [
      {
        "name": "service_name",
        "description": "The name of the service. Used for storage account naming.",
        "type": "string"
      },
      {
        "name": "resource_group_name",
        "description": "The name of the existing Resource Group in Azure.",
        "type": "string",
        "default": "terraform-demo"
      },
      {
        "name": "location",
        "description": "The Azure region to deploy to.",
        "type": "string",
        "default": "West Europe"
      },
      {
        "name": "performance_profile",
        "description": "The performance tier selected by the developer (sandbox, development, production).",
        "type": "string",
        "default": "sandbox"
      },
      {
        "name": "container_names",
        "description": "List of blob container names to create.",
        "type": "array",
        "default": ["default-container"]
      },
      {
        "name": "access_tier",
        "description": "The access tier for the storage account.",
        "type": "string",
        "default": "Hot"
      }
    ]
  }
}
